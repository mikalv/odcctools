builddir = @builddir@
top_builddir = @top_builddir@
srcdir = @srcdir@
top_srcdir = @top_srcdir@

VPATH = @srcdir@

CC		= @CC@
CFLAGS		= @CFLAGS@
MDYNAMICNOPIC	= @MDYNAMICNOPIC@
CPPFLAGS	= @CPPFLAGS@
DEFS		= @DEFS@
LDFLAGS		= @LDFLAGS@

MYINCLUDES	= -I$(top_builddir)include -I$(top_srcdir)include
MYWARNINGS	= -Wall -Wno-long-double
MYDEFS		= -DINTERIM_PPC64

MYCOMPILEFLAGS = $(CFLAGS) $(MDYNAMICNOPIC) $(CPPFLAGS) $(DEFS) \
	$(MYINCLUDES) $(MYWARNINGS) $(MYDEFS)

default: libstuff.a

CFILES = allocate.c errors.c arch.c execute.c bytesex.c round.c hppa.c \
	  swap_headers.c reloc.c version_number.c get_toc_byte_sex.c \
	  best_arch.c fatals.c arch_usage.c ofile.c ofile_error.c print.c \
	  set_arch_flag_name.c seg_addr_table.c dylib_table.c \
	  breakout.c writeout.c checkout.c fatal_arch.c ofile_get_word.c \
	  vm_flush_cache.c hash_string.c dylib_roots.c guess_short_name.c \
	  SymLoc.c get_arch_from_host.c crc32.c macosx_deployment_target.c \
	  symbol_list.c

OBJS = $(CFILES:.c=.o)

libstuff.a: $(OBJS)
	libtool -static -o $@ $^

.c.o:
	$(CC) $(MYCOMPILEFLAGS) -c -o $@ $<

clean shlib_clean:
	rm -r -f *.o
	rm -f libstuff.a

install: all

